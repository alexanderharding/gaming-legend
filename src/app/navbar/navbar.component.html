<div class="sticky-top">
  <nav class="navbar navbar-expand-md navbar-dark bg-dark">
    <a class="navbar-brand text-capitalize" routerLink="/welcome">{{
      pageTitle
    }}</a>

    <!-- Step 3: Toggle the value of the property when the toggler button is clicked. -->
    <button
      class="navbar-toggler"
      type="button"
      (click)="isMenuCollapsed = !isMenuCollapsed"
    >
      <svg
        *ngIf="!isMenuCollapsed; else menuDown"
        width="1.25em"
        height="1.25em"
        viewBox="0 0 16 16"
        class="bi bi-x"
        fill="currentColor"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fill-rule="evenodd"
          d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"
        />
      </svg>
      <ng-template #menuDown>
        <svg
          width="1.25em"
          height="1.25em"
          viewBox="0 0 16 16"
          class="bi bi-menu-down"
          fill="currentColor"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            d="M15 13V4a1 1 0 0 0-1-1h-3.586A2 2 0 0 1 9 2.414l-1-1-1 1A2 2 0 0 1 5.586 3H2a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1zM2 2a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-3.586a1 1 0 0 1-.707-.293L8.354.354a.5.5 0 0 0-.708 0L6.293 1.707A1 1 0 0 1 5.586 2H2z"
          />
          <path
            fill-rule="evenodd"
            d="M15 11H1v-1h14v1zm0-4H1V6h14v1zM2 12.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 0 1h-8a.5.5 0 0 1-.5-.5z"
          />
        </svg>
      </ng-template>
    </button>

    <!-- Step 2: Add the ngbCollapse directive to the element below. -->
    <div [ngbCollapse]="isMenuCollapsed" class="collapse navbar-collapse">
      <ul class="navbar-nav">
        <li class="nav-item">
          <!-- Step 4: Close the menu when a link is clicked. -->
          <a
            class="nav-link"
            routerLink="/welcome"
            routerLinkActive="active"
            (click)="isMenuCollapsed = true"
            >Home</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            routerLink="/products"
            routerLinkActive="active"
            (click)="isMenuCollapsed = true"
            [routerLinkActiveOptions]="{ exact: true }"
            >Products</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            routerLink="/cart"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{ exact: true }"
            (click)="isMenuCollapsed = true"
          >
            Cart
            <ng-container *ngIf="cartQuantity$ | async as quantity">
              <span class="badge badge-danger">{{ quantity }}</span>
            </ng-container>
          </a>
        </li>
        <ng-container *ngIf="currentUser$ | async as user; else noUser">
          <li class="nav-item">
            <a
              class="nav-link text-capitalize"
              routerLink="/account"
              routerLinkActive="active"
              [routerLinkActiveOptions]="{ exact: true }"
              (click)="isMenuCollapsed = true"
              >{{ user.firstName | lowercase }}'s Account</a
            >
          </li>
        </ng-container>
        <ng-template #noUser>
          <li class="nav-item">
            <a
              class="nav-link"
              routerLink="/user"
              routerLinkActive="active"
              (click)="isMenuCollapsed = true"
              >Sign In</a
            >
          </li>
        </ng-template>
      </ul>
    </div>
  </nav>
  <ngb-alert
    *ngIf="errorMessage"
    [dismissible]="false"
    type="danger"
    class="text-center"
  >
    <span>{{ errorMessage }}</span>
  </ngb-alert>
</div>
