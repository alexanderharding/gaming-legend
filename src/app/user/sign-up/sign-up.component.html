<div>
  <!-- <div class="row align-items-center">
    <div class="col">
      <h1 class="text-primary mb-3">Sign Up</h1>
    </div>
    <div class="col-auto">
      <input
        type="button"
        value="Create User"
        class="btn btn-sm btn-link text-dark"
        (click)="saveTestUser(false)"
      />
      <input
        type="button"
        value="Create Admin"
        class="btn btn-sm btn-link text-dark"
        (click)="saveTestUser(true)"
      />
    </div>
  </div> -->
  <h1 class="text-primary mb-3">Sign Up</h1>
  <div class="shadow-lg">
    <ngb-accordion [destroyOnHide]="false" activeIds="name" #acc="ngbAccordion">
      <ngb-panel
        type="{{
          this.signUpForm.get('nameGroup').invalid && submitted
            ? 'danger'
            : 'secondary'
        }}"
        id="name"
        title="name"
      >
        <ng-template ngbPanelHeader let-opened="opened">
          <div class="py-1">
            <button ngbPanelToggle class="btn btn-lg btn-link p-0 text-light">
              {{
                this.signUpForm.get("nameGroup").invalid && submitted ? "!" : ""
              }}
              Name
            </button>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <p>
            <ngb-progressbar type="primary" [value]="33"
              ><i>33%</i></ngb-progressbar
            >
          </p>
          <div class="mb-3">
            <ctacu-name-form
              [parentForm]="signUpForm"
              [submitted]="submitted"
            ></ctacu-name-form>
          </div>
          <div class="d-none d-sm-flex justify-content-end">
            <input
              type="button"
              value="next"
              (click)="acc.toggle('contact')"
              class="btn btn-success text-capitalize"
            />
          </div>
          <input
            type="button"
            value="next"
            (click)="acc.toggle('contact')"
            class="btn btn-sm btn-block btn-success text-capitalize d-sm-none"
          />
        </ng-template>
      </ngb-panel>
      <ngb-panel
        type="{{
          (this.signUpForm.get('contactGroup').invalid || emailTakenMessage) &&
          submitted
            ? 'danger'
            : 'secondary'
        }}"
        id="contact"
        title="contact"
      >
        <ng-template ngbPanelHeader let-opened="opened">
          <div class="py-1">
            <button ngbPanelToggle class="btn btn-lg btn-link p-0 text-light">
              {{
                (this.signUpForm.get("contactGroup").invalid ||
                  emailTakenMessage) &&
                submitted
                  ? "!"
                  : ""
              }}
              Contact Details
            </button>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <p>
            <ngb-progressbar type="primary" [value]="66"
              ><i>66%</i></ngb-progressbar
            >
          </p>
          <div class="mb-3">
            <ctacu-contact-form
              [parentForm]="signUpForm"
              [submitted]="submitted"
              [emailTakenMessage]="emailTakenMessage"
              (valueChange)="setEmailTakenMessage($event)"
            ></ctacu-contact-form>
          </div>
          <div class="d-none d-sm-flex justify-content-between">
            <input
              type="button"
              value="back"
              (click)="acc.toggle('name')"
              class="btn btn-primary text-capitalize"
            />
            <input
              type="button"
              value="next"
              (click)="acc.toggle('password')"
              class="btn btn-success text-capitalize"
            />
          </div>
          <input
            type="button"
            value="back"
            (click)="acc.toggle('name')"
            class="btn btn-sm btn-block btn-primary text-capitalize d-sm-none"
          />
          <input
            type="button"
            value="next"
            (click)="acc.toggle('password')"
            class="btn btn-sm btn-block btn-success text-capitalize d-sm-none"
          />
        </ng-template>
      </ngb-panel>
      <ngb-panel
        type="{{
          this.signUpForm.get('passwordGroup').invalid && submitted
            ? 'danger'
            : 'secondary'
        }}"
        id="password"
        title="password"
      >
        <ng-template ngbPanelHeader let-opened="opened">
          <div class="py-1">
            <button ngbPanelToggle class="btn btn-lg btn-link p-0 text-light">
              {{
                this.signUpForm.get("passwordGroup").invalid && submitted
                  ? "!"
                  : ""
              }}
              Password
            </button>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <p>
            <ngb-progressbar type="success" [value]="100"
              ><i>100%</i></ngb-progressbar
            >
          </p>
          <div class="mb-3">
            <ctacu-password-form
              [parentForm]="signUpForm"
              [submitted]="submitted"
              pageTitle="Password"
            ></ctacu-password-form>
          </div>
          <form
            [formGroup]="signUpForm"
            (ngSubmit)="onSubmit(signUpForm)"
            novalidate
          >
            <div class="d-none d-sm-flex justify-content-between">
              <input
                type="button"
                value="back"
                (click)="acc.toggle('contact')"
                class="btn btn-primary text-capitalize"
              />
              <input
                type="submit"
                value="{{
                  (signUpForm.invalid || emailTakenMessage) && submitted
                    ? '! '
                    : ''
                }}Sign Up"
                class="btn btn-block ml-2 text-capitalize"
                [disabled]="
                  ((signUpForm.invalid || emailTakenMessage) && submitted) ||
                  loading
                "
                [ngClass]="{
                  'btn-success':
                    (signUpForm.valid && !emailTakenMessage) || !submitted,
                  'btn-outline-danger':
                    (signUpForm.invalid || emailTakenMessage) && submitted
                }"
              />
            </div>
            <input
              type="button"
              value="back"
              (click)="acc.toggle('contact')"
              class="btn btn-sm btn-block btn-primary text-capitalize d-sm-none"
            />
            <input
              type="submit"
              value="{{
                (signUpForm.invalid || emailTakenMessage) && submitted
                  ? '! '
                  : ''
              }}Sign Up"
              class="btn btn-block text-capitalize d-sm-none"
              [disabled]="
                ((signUpForm.invalid || emailTakenMessage) && submitted) ||
                loading
              "
              [ngClass]="{
                'btn-success':
                  (signUpForm.valid && !emailTakenMessage) || !submitted,
                'btn-outline-danger':
                  (signUpForm.invalid || emailTakenMessage) && submitted
              }"
            />
          </form>
        </ng-template>
      </ngb-panel>
      <!-- <ngb-panel
              type="{{
                this.signUpForm.get('addressGroup').invalid && submitted
                  ? 'danger'
                  : 'secondary'
              }}"
              id="shipping"
              title="shipping"
            >
              <ng-template ngbPanelHeader let-opened="opened">
                <div class="py-1">
                  <button
                    ngbPanelToggle
                    class="btn btn-lg btn-link p-0 text-light"
                  >
                    {{
                      this.checkOutForm.get("addressGroup").invalid && submitted
                        ? "!"
                        : ""
                    }}
                    Shipping
                  </button>
                </div>
              </ng-template>
              <ng-template ngbPanelContent>
                <ctacu-shipping-panel-content
                  [checkOutForm]="checkOutForm"
                  [submitted]="submitted"
                  [shippingRates]="shippingRates"
                  [user]="user"
                  [streetMinLength]="streetMinLength"
                  [streetMaxLength]="streetMaxLength"
                  [cityMinLength]="cityMinLength"
                  [cityMaxLength]="cityMaxLength"
                  [states]="states"
                  (toggleChange)="acc.toggle($event)"
                  (newSubscription)="pushSubscription($event)"
                ></ctacu-shipping-panel-content>
              </ng-template>
            </ngb-panel>
            <ngb-panel
              type="{{
                (this.checkOutForm.get('paymentGroup').invalid ||
                  this.checkOutForm.get('signUpGroup').invalid) &&
                submitted
                  ? 'danger'
                  : 'secondary'
              }}"
              id="finalize"
              title="finalize"
            >
              <ng-template ngbPanelHeader let-opened="opened">
                <div class="py-1">
                  <button
                    ngbPanelToggle
                    class="btn btn-lg btn-link p-0 text-light text-capitalize"
                  >
                    {{
                      (this.checkOutForm.get("paymentGroup").invalid ||
                        this.checkOutForm.get("signUpGroup").invalid) &&
                      submitted
                        ? "!"
                        : ""
                    }}
                    Finalize
                  </button>
                </div>
              </ng-template>
              <ng-template ngbPanelContent>
                <ctacu-finalize-panel-content
                  [checkOutForm]="checkOutForm"
                  [user]="user"
                  [submitted]="submitted"
                  [errorMessage]="errorMessage"
                  [signUpError]="signUpError"
                  [isLoading]="isLoading"
                  [subtotal$]="subtotal$"
                  (toggleChange)="acc.toggle($event)"
                  (checkChange)="setPasswordValidation($event)"
                  (onSubmit)="onSubmit($event, items)"
                  (totalChange)="setTotal($event)"
                  (newSubscription)="pushSubscription($event)"
                >
                </ctacu-finalize-panel-content>
              </ng-template>
            </ngb-panel> -->
    </ngb-accordion>
  </div>
</div>
<ng-template #signUpErrTpl>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    fill="currentColor"
    class="bi bi-exclamation-octagon-fill mr-1"
    viewBox="0 0 16 16"
  >
    <path
      d="M11.46.146A.5.5 0 0 0 11.107 0H4.893a.5.5 0 0 0-.353.146L.146 4.54A.5.5 0 0 0 0 4.893v6.214a.5.5 0 0 0 .146.353l4.394 4.394a.5.5 0 0 0 .353.146h6.214a.5.5 0 0 0 .353-.146l4.394-4.394a.5.5 0 0 0 .146-.353V4.893a.5.5 0 0 0-.146-.353L11.46.146zM8 4c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995A.905.905 0 0 1 8 4zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
    />
  </svg>
  Error signing up !
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    fill="currentColor"
    class="bi bi-x pointer"
    viewBox="0 0 16 16"
  >
    <path
      d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"
    />
  </svg>
</ng-template>
